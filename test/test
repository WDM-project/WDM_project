":\"2023-06-01T13:45:59.5222171Z\",\"update_time\":\"2023-06-01T13:45:59.5222171Z\",\"gid\":\"58c1398c-6851-4db5-8885-c2d102454eea\",\"trans_type\":\"saga\",\"status\":\"submitted\",\"protocol\":\"http\",\"options\":\"{\\\"request_timeout\\\":8,\\\"concurrent\\\":false}\",\"next_cron_interval\":10,\"next_cron_time\":\"2023-06-01T13:46:09.522198Z\",\"request_timeout\":8,\"concurrent\":false} branches: [{\"id\":0,\"create_time\":\"2023-06-01T13:45:59.5222171Z\",\"update_time\":\"2023-06-01T13:45:59.5222171Z\",\"gid\":\"58c1398c-6851-4db5-8885-c2d102454eea\",\"url\":\"http://gateway:80/orders/checkoutCompensate/58c1398c-6851-4db5-8885-c2d102454eea\",\"bin_data\":\"eyJvcmRlcl9pZCI6ICI1OGMxMzk4Yy02ODUxLTRkYjUtODg4NS1jMmQxMDI0NTRlZWEifQ==\",\"branch_id\":\"01\",\"op\":\"compensate\",\"status\":\"prepared\"},{\"id\":0,\"create_time\":\"2023-06-01T13:45:59.5222171Z\",\"update_time\":\"2023-06-01T13:45:59.5222171Z\",\"gid\":\"58c1398c-6851-4db5-8885-c2d102454eea\",\"url\":\"http://gateway:80/orders/checkoutSaga/58c1398c-6851-4db5-8885-c2d102454eea\",\"bin_data\":\"eyJvcmRlcl9pZCI6ICI1OGMxMzk4Yy02ODUxLTRkYjUtODg4NS1jMmQxMDI0NTRlZWEifQ==\",\"branch_id\":\"01\",\"op\":\"action\",\"status\":\"prepared\"}]"}
wdm_project-dtm-1              | {"level":"info","ts":"2023-06-01T13:45:59.522Z","caller":"dtmutil/utils.go:118","msg":" 0ms 200 POST /api/dtmsvr/submit {\"dtm_result\":\"SUCCESS\"}"}
wdm_project-dtm-1              | {"level":"info","ts":"2023-06-01T13:45:59.538Z","caller":"dtmsvr/trans_status.go:95","msg":"LockGlobalSaveBranches ok: gid: 58c1398c-6851-4db5-8885-c2d102454eea old status: prepared branches: {\"id\":0,\"create_time\":\"2023-06-01T13:45:59.5222171Z\",\"update_time\":\"2023-06-01T13:45:59.5381464Z\",\"gid\":\"58c1398c-6851-4db5-8885-c2d102454eea\",\"url\":\"http://gateway:80/orders/checkoutSaga/58c1398c-6851-4db5-8885-c2d102454eea\",\"bin_data\":\"eyJvcmRlcl9pZCI6ICI1OGMxMzk4Yy02ODUxLTRkYjUtODg4NS1jMmQxMDI0NTRlZWEifQ==\",\"branch_id\":\"01\",\"op\":\"action\",\"status\":\"failed\",\"finish_time\":\"2023-06-01T13:45:59.5381464Z\"}"}
wdm_project-dtm-1              | {"level":"info","ts":"2023-06-01T13:45:59.538Z","caller":"dtmsvr/trans_status.go:84","msg":"ChangeGlobalStatus to aborting ok for {\"id\":0,\"create_time\":\"2023-06-01T13:45:59.5222171Z\",\"update_time\":\"2023-06-01T13:45:59.5385724Z\",\"gid\":\"58c1398c-6851-4db5-8885-c2d102454eea\",\"trans_type\":\"saga\",\"status\":\"aborting\",\"protocol\":\"http\",\"rollback_reason\":\"url:http://gateway:80/orders/checkoutSaga/58c1398c-6851-4db5-8885-c2d102454eea return failed: {\\\"error\\\":\\\"Not enough stock\\\"} FAILURE\",\"options\":\"{\\\"request_timeout\\\":8,\\\"concurrent\\\":false}\",\"next_cron_interval\":10,\"next_cron_time\":\"2023-06-01T13:46:09.522198Z\",\"request_timeout\":8,\"concurrent\":false}"}
wdm_project-gateway-1          | 2023/06/01 13:45:59 [error] 22#22: *25 upstream sent no valid HTTP/1.0 header while reading response header from upstream, client: 172.21.0.9, server: , request: "POST /orders/checkoutCompensate/58c1398c-6851-4db5-8885-c2d102454eea?branch_id=01&gid=58c1398c-6851-4db5-8885-c2d102454eea&op=compensate&trans_type=saga HTTP/1.1", upstream: "http://172.21.0.5:5000/checkoutCompensate/58c1398c-6851-4db5-8885-c2d102454eea?branch_id=01&gid=58c1398c-6851-4db5-8885-c2d102454eea&op=compensate&trans_type=saga", host: "gateway:80"
wdm_project-dtm-1              | {"level":"info","ts":"2023-06-01T13:45:59.555Z","caller":"dtmsvr/trans_status.go:38","msg":"TouchCronTime for: {\"id\":0,\"create_time\":\"2023-06-01T13:45:59.5222171Z\",\"update_time\":\"2023-06-01T13:45:59.5547314Z\",\"gid\":\"58c1398c-6851-4db5-8885-c2d102454eea\",\"trans_type\":\"saga\",\"status\":\"aborting\",\"protocol\":\"http\",\"rollback_reason\":\"url:http://gateway:80/orders/checkoutSaga/58c1398c-6851-4db5-8885-c2d102454eea return failed: {\\\"error\\\":\\\"Not enough stock\\\"} FAILURE\",\"options\":\"{\\\"request_timeout\\\":8,\\\"concurrent\\\":false}\",\"next_cron_interval\":20,\"next_cron_time\":\"2023-06-01T13:46:19.5547298Z\",\"request_timeout\":8,\"concurrent\":false}"}
wdm_project-dtm-1              | {"level":"error","ts":"2023-06-01T13:45:59.555Z","caller":"dtmsvr/trans_type_saga.go:132","msg":"exec branch 01 compensate http://gateway:80/orders/checkoutCompensate/58c1398c-6851-4db5-8885-c2d102454eea error: your http/grpc result should be specified as in:\nhttp://d.dtm.pub/practice/arch.html#proto\nunkown result will be retried: Post \"http://gateway:80/orders/checkoutCompensate/58c1398c-6851-4db5-8885-c2d102454eea?branch_id=01&gid=58c1398c-6851-4db5-8885-c2d102454eea&op=compensate&trans_type=saga\": net/http: HTTP/1.x transport connection broken: malformed HTTP status code \"0\"","stacktrace":"github.com/dtm-labs/dtm/dtmsvr.(*transSagaProcessor).ProcessOnce.func3.1\n\t/app/dtm/dtmsvr/trans_type_saga.go:132\ngithub.com/dtm-labs/dtm/dtmsvr.(*transSagaProcessor).ProcessOnce.func3\n\t/app/dtm/dtmsvr/trans_type_saga.go:136"}